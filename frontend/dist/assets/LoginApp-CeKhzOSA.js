import{c as o,a,b as w,w as h,v,h as b,t as k,d as y,e as l,i as f,f as r}from"./index-DPEeJoVm.js";import{a as _}from"./api-DbpbKoG9.js";const V={class:"card"},x={class:"admin-login"},T={class:"form-row"},A={class:"form-row"},B=["disabled"],M={key:0},S={key:1},K={key:0,class:"message message-error",style:{"margin-top":"0.75rem"}},q={__name:"LoginApp",setup(L){const i=l(""),u=l(""),n=l(!1),t=l(""),d=f(()=>i.value.trim()),m=f(()=>u.value.trim());function g(){const s=`${d.value}:${m.value}`;return btoa(s)}async function p(){if(!(!d.value||!m.value||n.value)){n.value=!0,t.value="";try{const s=g(),e=await fetch(_("/api/admin/results"),{headers:{Authorization:"Basic "+s}});if(!e.ok){e.status===401||e.status===403?t.value="Sai tài khoản hoặc mật khẩu.":t.value="Không thể đăng nhập. Vui lòng thử lại sau.";return}localStorage.setItem("adminAuth",s),window.location.href="/admin"}catch(s){console.error("Login failed",s),t.value="Có lỗi khi đăng nhập. Vui lòng thử lại."}finally{n.value=!1}}}return(s,e)=>(r(),o("main",V,[e[4]||(e[4]=a("header",{class:"card-header"},[a("h1",{class:"card-title"},"Đăng nhập hệ thống bình chọn"),a("p",{class:"card-subtitle"}," Vui lòng đăng nhập để quản lý cuộc bình chọn và xem kết quả. ")],-1)),a("section",x,[a("form",{class:"login-form",onSubmit:w(p,["prevent"])},[a("div",T,[e[2]||(e[2]=a("label",{for:"username"},"Tài khoản",-1)),h(a("input",{id:"username","onUpdate:modelValue":e[0]||(e[0]=c=>i.value=c),type:"text",autocomplete:"username",placeholder:"admin"},null,512),[[v,i.value]])]),a("div",A,[e[3]||(e[3]=a("label",{for:"password"},"Mật khẩu",-1)),h(a("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=c=>u.value=c),type:"password",autocomplete:"current-password",placeholder:"Nhập mật khẩu",onKeyup:b(p,["enter"])},null,544),[[v,u.value]])]),a("button",{class:"btn btn-primary",type:"submit",disabled:n.value||!d.value||!m.value},[n.value?(r(),o("span",S,"Đang xử lý...")):(r(),o("span",M,"Đăng nhập"))],8,B)],32),t.value?(r(),o("div",K,k(t.value),1)):y("",!0)])]))}};export{q as default};
